# BuildStream + Buildbarn PoC Project
# Demonstrates remote execution via your existing Buildbarn cluster
# Extended for AOSP toolchain integration

name: buildstream-buildbarn-poc
min-version: 2.0

element-path: elements

# Register external plugins
plugins:
- origin: pip
  package-name: buildstream-plugins
  elements:
  - make
  - cmake
  - autotools
  sources:
  - git

# Register local AOSP plugins
- origin: local
  path: plugins/elements
  elements:
  - aosp_cc

# Register local source plugins
- origin: local
  path: plugins/sources
  sources:
  - local_external

# Default variables
variables:
  prefix: /usr

  # AOSP paths
  aosp-root: /home/vgrade/AAOS-RE/aosp
  clang-version: clang-r522817
  target-arch: x86_64

# Sandbox configuration - use host tools for local builds
# For remote execution, a proper sysroot would be needed
sandbox:
  build-uid: 0
  build-gid: 0

# Allow using host /usr for build tools
# This is needed for local builds without a full sysroot
split-rules:
  runtime:
  - "%{bindir}/*"
  - "%{libdir}/*"
